---

copyright:
  years: 2018, 2019
lastupdated: "2019-06-12"

keywords: Block Storage, accessible Primary volume, duplicate of a replica volume, Disaster Recovery, volume duplication, replication, failover, failback

subcollection: BlockStorage

---
{:external: target="_blank" .external}
{:tip: .tip}
{:note: .note}
{:important: .important}
{:DomainName: data-hd-keyref="APPDomain"}
{:DomainName: data-hd-keyref="DomainName"}

# 災害復旧 - 1 次ボリュームがアクセス可能である場合のフェイルオーバー
{: #dr-accessible}

1 次サイトで致命的な障害や災害が発生したものの、まだ 1 次ストレージにアクセス可能な場合は、以下の操作を実行して、2 次サイトのデータに速やかにアクセスできます。

フェイルオーバーを開始する前に、ホストの許可がすべて正しく設定されていることを確認してください。
{:important}

許可されたホストとボリュームは、同じデータ・センター内に存在する必要があります。 例えば、レプリカ・ボリュームをロンドンに置き、ホストをアムステルダムに置くことはできません。 両方がロンドンに存在するか、両方がアムステルダムに存在する必要があります。
{:note}

1. [{{site.data.keyword.cloud_notm}} コンソール](https://{DomainName}/){: external}にログインして、左上にある**「メニュー」**アイコンをクリックします。**「クラシック・インフラストラクチャー」**を選択します。
2. ソース・ボリュームまたは宛先ボリュームを、**「{{site.data.keyword.blockstorageshort}}」**ページでクリックします。
3. **「レプリカ」**をクリックします。
4. **「ホストの許可」**フレームまでスクロールダウンして、右にある**「ホストの許可」**をクリックします。
5. レプリケーション用に許可するホストを強調表示します。 複数のホストを選択するには、Ctrl キーを使用して該当するホストをクリックします。
6. **「送信」**をクリックします。 使用可能なホストがない場合は、同じデータ・センターでコンピュート・リソースを購入するよう求めるプロンプトが出されます。


## ボリュームからそのレプリカへのフェイルオーバーの開始

障害が発生するおそれがある場合、宛先 (つまりターゲット) ボリュームへの**フェイルオーバー**を開始できます。 ターゲット・ボリュームがアクティブになります。 最後に正常に複製されたスナップショットがアクティブになり、ボリュームがマウント可能になります。 前回のレプリケーション・サイクル以降にソース・ボリュームに書き込まれたデータは、すべて失われます。 

フェイルオーバーが開始されると、レプリケーションの関係が反転します。 ターゲット・ボリュームがソース・ボリュームになり、以前のソース・ボリュームは、**「LUN 名」**の後に **REP** を付けて示されるターゲットになります。

フェイルオーバーは、[[{{site.data.keyword.cloud}} コンソール](https://{DomainName}/classic){: external}の**「ストレージ」**の**「{{site.data.keyword.blockstorageshort}}」**で開始されます。

これらのステップに進む前に、ボリュームを切り離します。そうしないと、破損やデータ損失が発生します。
{:important}

1. アクティブな LUN (「ソース」) をクリックします。
2. **「レプリカ」**をクリックし、**「アクション」**をクリックします。
3. **「フェイルオーバー」**を選択します。

   ページにフェイルオーバーが進行中であることを示すメッセージが表示されます。 また、**{{site.data.keyword.blockstorageshort}}** ページ上のボリュームの横に、アクティブなトランザクションが発生していることを示すアイコンが表示されます。アイコンの上にカーソルを移動すると、トランザクションを示すウィンドウが生成されます。 アイコンは、トランザクションが完了すると表示されなくなります。 フェイルオーバー・プロセス中、構成に関連したアクションは読み取り専用になります。 スナップショット・スケジュールを編集したり、スナップショット・スペースを変更したりすることはできません。 このイベントは、レプリケーション履歴にログとして記録されます。<br/> ターゲット・ボリュームが稼働している場合は、別のメッセージが表示されます。 元のソース・ボリュームの LUN 名が「REP」で終わるように更新され、その状況の表示が「非アクティブ」になります。
   {:note}
4. **「すべての {{site.data.keyword.blockstorageshort}} の表示 (View All {{site.data.keyword.blockstorageshort}})」**をクリックします。
5. アクティブな LUN (前のターゲット・ボリューム) をクリックします。
6. ストレージ・ボリュームをホストにマウントして、接続します。 詳しくは、[ストレージの接続](/docs/infrastructure/BlockStorage?topic=BlockStorage-orderingthroughConsole#mountingnewLUN)を参照してください。


## ボリュームからそのレプリカへのフェイルバックの開始

元のソース・ボリュームが修復されたら、元のソース・ボリュームへの制御されたフェイルバックを開始できます。 制御されたフェイルバックでは、以下が行われます。

- 作動中のソース・ボリュームがオフラインにされます。
- スナップショットが取られます。
- レプリケーション・サイクルが完了します。
- 作成されたばかりのデータ・スナップショットがアクティブ化されます。
- ソース・ボリュームがマウント用にアクティブになります。

フェイルバックが開始されると、レプリケーションの関係が再び反転します。 ソース・ボリュームがソース・ボリュームとして復元され、ターゲット・ボリュームは、再度、**「LUN 名」**の後に **REP** を付けて示されるターゲット・ボリュームになります。

フェイルバックは、[{{site.data.keyword.cloud}} コンソール](https://{DomainName}/classic){: external}の**「ストレージ」**の**「{{site.data.keyword.blockstorageshort}}」**で開始されます。

1. アクティブな LUN (「ターゲット」) をクリックします。
2. 右上にある**「レプリカ」**をクリックし、**「アクション」**をクリックします。
3. **「フェイルバック」**を選択します。

   ページにフェイルオーバーが進行中であることを示すメッセージが表示されます。 また、**{{site.data.keyword.blockstorageshort}}** 上のボリュームの横に、アクティブなトランザクションが発生していることを示すアイコンが表示されます。 アイコンの上にカーソルを移動すると、トランザクションを示すウィンドウが生成されます。 アイコンは、トランザクションが完了すると表示されなくなります。 フェイルバック・プロセス中、構成に関連したアクションは読み取り専用になります。 スナップショット・スケジュールを編集したり、スナップショット・スペースを変更したりすることはできません。 このイベントは、レプリケーション履歴に記録されます。
   {:note}
4. 右上にある**「すべての {{site.data.keyword.blockstorageshort}} の表示 (View All {{site.data.keyword.blockstorageshort}})」**をクリックします。
5. アクティブな LUN (「ソース」) をクリックします。
6. ストレージ・ボリュームをホストにマウントして、接続します。 詳しくは、[ストレージの接続](/docs/infrastructure/BlockStorage?topic=BlockStorage-orderingthroughConsole#mountingnewLUN)を参照してください。
